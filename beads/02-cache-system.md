# üíæ –ó–∞–¥–∞—á–∞ #2: –°–∏—Å—Ç–µ–º–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

## üìä –°—Ç–∞—Ç—É—Å: ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –°–†–ï–î–ù–ò–ô  
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-01-XX  
**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 2025-01-XX

---

## üéØ –û–ø–∏—Å–∞–Ω–∏–µ

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

---

## ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –û—Ç–∫–ª—é—á–µ–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —Ç–µ—Å—Ç–æ–≤
**–ü—Ä–∏—á–∏–Ω–∞:** –¢–µ—Å—Ç—ã –¥–æ–ª–∂–Ω—ã –≤—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

**–§–∞–π–ª—ã:**
- `server/src/routes/test.routes.ts`
- `server/src/routes/blockTest.routes.ts`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
```typescript
// –ë–´–õ–û:
router.get('/', authenticate, cacheMiddleware(180), async (req, res) => { ... });

// –°–¢–ê–õ–û:
router.get('/', authenticate, async (req, res) => {
  // ...
  res.setHeader('Cache-Control', 'no-cache, no-store, must-revalidate');
  res.setHeader('Pragma', 'no-cache');
  res.setHeader('Expires', '0');
  // ...
});
```

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –∫—ç—à-–∫–ª—é—á–µ–π
**–ü—Ä–æ–±–ª–µ–º–∞:** Timestamp –≤ URL —Å–æ–∑–¥–∞–≤–∞–ª —Ä–∞–∑–Ω—ã–µ –∫–ª—é—á–∏ –∫—ç—à–∞

**–§–∞–π–ª:** `server/src/middleware/cache.ts`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
```typescript
// –ë–´–õ–û:
const cacheKey = `cache:${req.originalUrl || req.url}`;

// –°–¢–ê–õ–û:
const url = req.originalUrl || req.url;
const urlWithoutTimestamp = url.split('?')[0]; // –£–±–∏—Ä–∞–µ–º query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
const cacheKey = `cache:${urlWithoutTimestamp}`;
```

### 3. –£–¥–∞–ª–µ–Ω–∞ –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—ç—à–∞
**–ü—Ä–∏—á–∏–Ω–∞:** –ö—ç—à–∞ –±–æ–ª—å—à–µ –Ω–µ—Ç –¥–ª—è —Ç–µ—Å—Ç–æ–≤

**–£–¥–∞–ª–µ–Ω–æ –∏–∑:**
- `POST /tests` - —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞
- `POST /tests/import/confirm` - –∏–º–ø–æ—Ä—Ç —Ç–µ—Å—Ç–∞
- `PUT /tests/:id` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–∞
- `DELETE /tests/:id` - —É–¥–∞–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–∞
- –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è –±–ª–æ–∫-—Ç–µ—Å—Ç–æ–≤

---

## üìã –ì–¥–µ –∫—ç—à –ï–©–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

### –†–æ—É—Ç—ã —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º:
1. `GET /subjects` - —Å–ø–∏—Å–æ–∫ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ (—Ä–µ–¥–∫–æ –º–µ–Ω—è–µ—Ç—Å—è)
2. `GET /branches` - —Å–ø–∏—Å–æ–∫ —Ñ–∏–ª–∏–∞–ª–æ–≤ (—Ä–µ–¥–∫–æ –º–µ–Ω—è–µ—Ç—Å—è)
3. `GET /groups` - —Å–ø–∏—Å–æ–∫ –≥—Ä—É–ø–ø (–º–æ–∂–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å—Å—è)
4. `GET /students` - —Å–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ (–º–æ–∂–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å—Å—è)
5. `GET /statistics` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–º–æ–∂–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å—Å—è)

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
- ‚úÖ –û—Å—Ç–∞–≤–∏—Ç—å –∫—ç—à –¥–ª—è —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ (subjects, branches)
- ‚ö†Ô∏è –£–º–µ–Ω—å—à–∏—Ç—å TTL –¥–ª—è –≥—Ä—É–ø–ø –∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ (60 —Å–µ–∫—É–Ω–¥)
- ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—é –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö

---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫—ç—à–∞

### Redis –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
**–§–∞–π–ª:** `server/src/config/redis.ts`

```typescript
// –¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
host: process.env.REDIS_HOST || 'localhost'
port: process.env.REDIS_PORT || 6379
```

### TTL (Time To Live)
- –¢–µ—Å—Ç—ã: **0 —Å–µ–∫—É–Ω–¥** (–æ—Ç–∫–ª—é—á–µ–Ω–æ)
- –ë–ª–æ–∫-—Ç–µ—Å—Ç—ã: **0 —Å–µ–∫—É–Ω–¥** (–æ—Ç–∫–ª—é—á–µ–Ω–æ)
- –ü—Ä–µ–¥–º–µ—Ç—ã: **300 —Å–µ–∫—É–Ω–¥** (5 –º–∏–Ω—É—Ç)
- –§–∏–ª–∏–∞–ª—ã: **300 —Å–µ–∫—É–Ω–¥** (5 –º–∏–Ω—É—Ç)
- –ì—Ä—É–ø–ø—ã: **180 —Å–µ–∫—É–Ω–¥** (3 –º–∏–Ω—É—Ç—ã)
- –°—Ç—É–¥–µ–Ω—Ç—ã: **180 —Å–µ–∫—É–Ω–¥** (3 –º–∏–Ω—É—Ç—ã)

---

## üêõ –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞ #1: Redis –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
**–°–∏–º–ø—Ç–æ–º—ã:** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –º–µ–¥–ª–µ–Ω–Ω–æ

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å Redis
redis-cli ping

# –ó–∞–ø—É—Å—Ç–∏—Ç—å Redis
redis-server

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
redis-cli
> KEYS cache:*
```

### –ü—Ä–æ–±–ª–µ–º–∞ #2: –ö—ç—à –Ω–µ –æ—á–∏—â–∞–µ—Ç—Å—è
**–°–∏–º–ø—Ç–æ–º—ã:** –°—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –¥—Ä—É–≥–∏—Ö —Ä–æ—É—Ç–∞—Ö

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –û—á–∏—Å—Ç–∏—Ç—å –≤–µ—Å—å –∫—ç—à
redis-cli FLUSHDB

# –û—á–∏—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω
redis-cli KEYS "cache:/api/groups*" | xargs redis-cli DEL
```

### –ü—Ä–æ–±–ª–µ–º–∞ #3: –ü–∞–º—è—Ç—å Redis –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∞
**–°–∏–º–ø—Ç–æ–º—ã:** –û—à–∏–±–∫–∏ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –≤ –∫—ç—à

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
redis-cli INFO memory

# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å maxmemory –≤ redis.conf
maxmemory 256mb
maxmemory-policy allkeys-lru
```

---

## üìö –°–≤—è–∑–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

- `beads/01-test-import-issue.md` - –ü—Ä–æ–±–ª–µ–º–∞ —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º —Ç–µ—Å—Ç–æ–≤
- `beads/04-database-queries.md` - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

---

**–°—Ç–∞—Ç—É—Å:** –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —Ç–µ—Å—Ç–æ–≤ –æ—Ç–∫–ª—é—á–µ–Ω–æ, —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
